<html>

</html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scoreboard creator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/node-uuid/1.4.8/uuid.min.js"
    integrity="sha384-ojT96dIkO5uDUptuYUBcwQK3flLsTlH0IH2eqFDFzvsvyWu+Uj6z6kjaCUzanmkf"
    crossorigin="anonymous"></script>
  <link href="css/css.css" rel="stylesheet">
  <script src="js/jquery-3.4.1.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/styles.css">
</head>

<body>
  <div class="container">
    <div class="row text-center">
      <div class="col-xs-12 col-md-6">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title">–°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã</h3>
          </div>
          <div class="panel-body">
            <div class="panel-body">
              <label for="game_id">Game ID</label>
              <input id="game_id" value="demo" style="flex: 1; font-size: 18px; width: 100%; padding: 10px;">
            </div>
            <div class="panel-body">
              <a class="scoreboard-btn btn btn-sm btn-info" target="_blank" href="#">–¢–∞–±–ª–æ</a>
              <button id="copy_scoreboard_btn" type="button" class="btn btn-sm btn-info" style="margin-left: 5px;">üìã
                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
              <br>
              <span id="scoreboard_link"
                style="font-size: 12px; color: #666; word-break: break-all; display: block; margin-top: 5px;"></span>
              <hr />
              <a class="ctl-btn btn btn-sm btn-info" target="_blank" href="#">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a>
              <button id="copy_ctl_btn" type="button" class="btn btn-sm btn-info" style="margin-left: 5px;">üìã
                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
              <br>
              <span id="ctl_link"
                style="font-size: 12px; color: #666; word-break: break-all; display: block; margin-top: 5px;"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      var scoreboard_url = '';
      var ctl_url = '';

      function copyToClipboard(text, buttonId) {
        var button = document.getElementById(buttonId);
        var originalText = button.textContent;

        // –ò—Å–ø–æ–ª—å–∑—É–µ–º Clipboard API –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏–Ω–∞—á–µ fallback
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text)
            .then(function () {
              button.textContent = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
              setTimeout(function () {
                button.textContent = originalText;
              }, 2000);
            })
            .catch(function (err) {
              console.error('Failed to copy:', err);
              fallbackCopy(text, buttonId);
            });
        } else {
          fallbackCopy(text, buttonId);
        }
      }

      function fallbackCopy(text, buttonId) {
        var button = document.getElementById(buttonId);
        var originalText = button.textContent;
        var textarea = document.createElement('textarea');
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        try {
          document.execCommand('copy');
          button.textContent = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
          setTimeout(function () {
            button.textContent = originalText;
          }, 2000);
        } catch (err) {
          console.error('Fallback copy failed:', err);
        }
        document.body.removeChild(textarea);
      }

      $("#game_id").change(function () {
        console.log($(this).val());
        scoreboard_url = window.location.href.replace(/\/[^\/]*$/, "/scoreboard.html?game=" + $(this).val());
        ctl_url = window.location.href.replace(/\/[^\/]*$/, "/ctl.html?game=" + $(this).val());
        $(".ctl-btn").attr('href', ctl_url);
        $("#ctl_link").html(ctl_url);
        $(".scoreboard-btn").attr('href', scoreboard_url);
        $("#scoreboard_link").html(scoreboard_url);
      });

      $("#copy_scoreboard_btn").click(function () {
        if (scoreboard_url) copyToClipboard(scoreboard_url, 'copy_scoreboard_btn');
      });

      $("#copy_ctl_btn").click(function () {
        if (ctl_url) copyToClipboard(ctl_url, 'copy_ctl_btn');
      });

      $("#game_id").val(uuid()).change();
    </script>

</body>

</html>